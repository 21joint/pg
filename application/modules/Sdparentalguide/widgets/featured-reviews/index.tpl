<?php
/**
 * SocialEngine
 *
 * @category   Application_Extensions
 * @package    Sdparentalguide
 * @author     Stars Developer
 */

?>

<!--page section-->
<div class="page-section bg-light">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="content-box bg-sm-white">
          <div class="row">
            <div class="col-12">
              <h2 class="content-box--title mb-0">Featured Reviews</h2>
              <hr>
            </div>
            <div class="col-12 px-0 px-sm-3">
              <div class="row no-gutters cards-grid reviews"
                   id="featuredReviewsGrid"
                   data-filter="featured">
              </div>
            </div>
            <!--            <div class="col-12 px-0">-->
            <!--              <hr class="row">-->
            <!--              <div class="row">-->
            <!--                <div class="col-auto ml-sm-auto">-->
            <!--                  <nav aria-label="Page navigation example">-->
            <!--                    <ul class="pagination mb-0">-->
            <!--                      <li class="page-item pagination-nav">-->
            <!--                        <a class="page-link" href="#" aria-label="Previous">-->
            <!--                          <i aria-hidden="true" class="fa fa-chevron-left"></i>-->
            <!--                          <span class="sr-only">Previous</span>-->
            <!--                        </a>-->
            <!--                      </li>-->
            <!--                      <li class="page-item"><a class="page-link" href="#">1</a></li>-->
            <!--                      <li class="page-item"><a class="page-link" href="#">2</a></li>-->
            <!--                      <li class="page-item active"><a class="page-link" href="#">3</a></li>-->
            <!--                      <li class="page-item"><a class="page-link" href="#">...</a></li>-->
            <!--                      <li class="page-item"><a class="page-link" href="#">386</a></li>-->
            <!--                      <li class="page-item pagination-nav">-->
            <!--                        <a class="page-link" href="#" aria-label="Next">-->
            <!--                          <i aria-hidden="true" class="fa fa-chevron-right"></i>-->
            <!--                          <span class="sr-only">Next</span>-->
            <!--                        </a>-->
            <!--                      </li>-->
            <!--                    </ul>-->
            <!--                  </nav>-->
            <!--                </div>-->
            <!--              </div>-->
            <!--            </div>-->
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!--page section ends /-->

<!-- SINGLE REVIEW -->
<div id="reviewSingleModal" class="modal" tabindex="-1" role="dialog">
  <div class="prg-review">
    <div class="prg-review--hero position-relative"
         style="background-image: url(https://dzhywv9htu615.cloudfront.net/public/sitereview_listing/bf/8d/02/43691a2684f60db713b745e344f8fe54.JPG);">
      <img class="img-fluid w-100 invisible"
           src="https://dzhywv9htu615.cloudfront.net/public/sitereview_listing/bf/8d/02/43691a2684f60db713b745e344f8fe54.JPG"
           alt="">
      <div class="prg-review--stars">
        <div class="card-stars">
          <ul class="list-inline my-0">
            <li class="list-inline-item align-middle">
              <svg xmlns="http://www.w3.org/2000/svg"
                   xmlns:xlink="http://www.w3.org/1999/xlink"
                   viewBox="0 0 21.059 20">
                <defs>
                  <style> .cls-1 {
                      fill: url(#linear-gradient);
                    }

                    .cls-2 {
                      fill: url(#linear-gradient-2);
                    }

                    .cls-3 {
                      fill: url(#linear-gradient-3);
                    }</style>
                  <linearGradient id="linear-gradient"
                                  x1="-0.222"
                                  y1="0.952"
                                  x2="0.971"
                                  y2="-0.34"
                                  gradientUnits="objectBoundingBox">
                    <stop offset="0" stop-color="#ce8f2a"></stop>
                    <stop offset="0.17" stop-color="#cf9330"></stop>
                    <stop offset="0.38" stop-color="#d39d3f"></stop>
                    <stop offset="0.62" stop-color="#d8ae59"></stop>
                    <stop offset="0.67" stop-color="#dab360"></stop>
                    <stop offset="0.92" stop-color="#edc64f"></stop>
                    <stop offset="1" stop-color="#edc64f"></stop>
                  </linearGradient>
                  <linearGradient id="linear-gradient-2"
                                  x1="1.543"
                                  y1="1.119"
                                  x2="0.162"
                                  y2="-0.102"
                                  gradientUnits="objectBoundingBox">
                    <stop offset="0" stop-color="#ce8f2a"></stop>
                    <stop offset="0.17" stop-color="#a28f70"></stop>
                    <stop offset="0.38" stop-color="#d39d3f"></stop>
                    <stop offset="0.62" stop-color="#d8ae59"></stop>
                    <stop offset="0.67" stop-color="#dab360"></stop>
                    <stop offset="0.92" stop-color="#edc64f"></stop>
                    <stop offset="1" stop-color="#edc64f"></stop>
                  </linearGradient>
                  <linearGradient id="linear-gradient-3"
                                  x1="1.616"
                                  y1="1.474"
                                  x2="0.258"
                                  y2="-0.026"
                                  xlink:href="#linear-gradient"></linearGradient>
                </defs>
                <g id="Symbol_583_1" data-name="Symbol 583 – 1" transform="translate(-435 -1135)">
                  <path id="Path_1811"
                        data-name="Path 1811"
                        class="cls-1"
                        d="M173.963,249.27l-3.757,4.959L167,249.922l6.261-1.4C174.163,248.269,174.463,248.619,173.963,249.27Z"
                        transform="translate(281.182 890.03)"></path>
                  <path id="Path_1812"
                        data-name="Path 1812"
                        class="cls-2"
                        d="M149.407,253.5l-8.265,2.054c-.5.1-.651.7-.15.9l8.065,2.354Z"
                        transform="translate(294.316 887.504)"></path>
                  <path id="Path_1813"
                        data-name="Path 1813"
                        class="cls-3"
                        d="M156,260.741l1.052-18.734c0-.551.551-.651.9-.25l11.22,13.975c.4.5.3,1.352-.852.9l-6.762-2.6-4.208,7.013C156.9,261.843,155.948,261.543,156,260.741Z"
                        transform="translate(286.674 893.486)"></path>
                </g>
              </svg>
            </li>
            <li class="list-inline-item align-middle">
              <svg xmlns="http://www.w3.org/2000/svg"
                   xmlns:xlink="http://www.w3.org/1999/xlink"
                   viewBox="0 0 21.059 20">
                <g id="Symbol_583_1" data-name="Symbol 583 – 1" transform="translate(-435 -1135)">
                  <path id="Path_1811"
                        data-name="Path 1811"
                        class="cls-1"
                        d="M173.963,249.27l-3.757,4.959L167,249.922l6.261-1.4C174.163,248.269,174.463,248.619,173.963,249.27Z"
                        transform="translate(281.182 890.03)"></path>
                  <path id="Path_1812"
                        data-name="Path 1812"
                        class="cls-2"
                        d="M149.407,253.5l-8.265,2.054c-.5.1-.651.7-.15.9l8.065,2.354Z"
                        transform="translate(294.316 887.504)"></path>
                  <path id="Path_1813"
                        data-name="Path 1813"
                        class="cls-3"
                        d="M156,260.741l1.052-18.734c0-.551.551-.651.9-.25l11.22,13.975c.4.5.3,1.352-.852.9l-6.762-2.6-4.208,7.013C156.9,261.843,155.948,261.543,156,260.741Z"
                        transform="translate(286.674 893.486)"></path>
                </g>
              </svg>
            </li>
            <li class="list-inline-item align-middle">
              <svg xmlns="http://www.w3.org/2000/svg"
                   xmlns:xlink="http://www.w3.org/1999/xlink"
                   viewBox="0 0 21.059 20">
                <g id="Symbol_583_1" data-name="Symbol 583 – 1" transform="translate(-435 -1135)">
                  <path id="Path_1811"
                        data-name="Path 1811"
                        class="cls-1"
                        d="M173.963,249.27l-3.757,4.959L167,249.922l6.261-1.4C174.163,248.269,174.463,248.619,173.963,249.27Z"
                        transform="translate(281.182 890.03)"></path>
                  <path id="Path_1812"
                        data-name="Path 1812"
                        class="cls-2"
                        d="M149.407,253.5l-8.265,2.054c-.5.1-.651.7-.15.9l8.065,2.354Z"
                        transform="translate(294.316 887.504)"></path>
                  <path id="Path_1813"
                        data-name="Path 1813"
                        class="cls-3"
                        d="M156,260.741l1.052-18.734c0-.551.551-.651.9-.25l11.22,13.975c.4.5.3,1.352-.852.9l-6.762-2.6-4.208,7.013C156.9,261.843,155.948,261.543,156,260.741Z"
                        transform="translate(286.674 893.486)"></path>
                </g>
              </svg>
            </li>
            <li class="list-inline-item align-middle">
              <svg xmlns="http://www.w3.org/2000/svg"
                   xmlns:xlink="http://www.w3.org/1999/xlink"
                   viewBox="0 0 21.059 20">
                <g id="Symbol_583_1" data-name="Symbol 583 – 1" transform="translate(-435 -1135)">
                  <path id="Path_1811"
                        data-name="Path 1811"
                        class="cls-1"
                        d="M173.963,249.27l-3.757,4.959L167,249.922l6.261-1.4C174.163,248.269,174.463,248.619,173.963,249.27Z"
                        transform="translate(281.182 890.03)"></path>
                  <path id="Path_1812"
                        data-name="Path 1812"
                        class="cls-2"
                        d="M149.407,253.5l-8.265,2.054c-.5.1-.651.7-.15.9l8.065,2.354Z"
                        transform="translate(294.316 887.504)"></path>
                  <path id="Path_1813"
                        data-name="Path 1813"
                        class="cls-3"
                        d="M156,260.741l1.052-18.734c0-.551.551-.651.9-.25l11.22,13.975c.4.5.3,1.352-.852.9l-6.762-2.6-4.208,7.013C156.9,261.843,155.948,261.543,156,260.741Z"
                        transform="translate(286.674 893.486)"></path>
                </g>
              </svg>
            </li>
            <li class="list-inline-item align-middle">
              <svg xmlns="http://www.w3.org/2000/svg"
                   xmlns:xlink="http://www.w3.org/1999/xlink"
                   viewBox="0 0 21.059 20">
                <g id="Symbol_583_1" data-name="Symbol 583 – 1" transform="translate(-435 -1135)">
                  <path id="Path_1811"
                        data-name="Path 1811"
                        class="cls-1"
                        d="M173.963,249.27l-3.757,4.959L167,249.922l6.261-1.4C174.163,248.269,174.463,248.619,173.963,249.27Z"
                        transform="translate(281.182 890.03)"></path>
                  <path id="Path_1812"
                        data-name="Path 1812"
                        class="cls-2"
                        d="M149.407,253.5l-8.265,2.054c-.5.1-.651.7-.15.9l8.065,2.354Z"
                        transform="translate(294.316 887.504)"></path>
                  <path id="Path_1813"
                        data-name="Path 1813"
                        class="cls-3"
                        d="M156,260.741l1.052-18.734c0-.551.551-.651.9-.25l11.22,13.975c.4.5.3,1.352-.852.9l-6.762-2.6-4.208,7.013C156.9,261.843,155.948,261.543,156,260.741Z"
                        transform="translate(286.674 893.486)"></path>
                </g>
              </svg>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- SINGLE REVIEW ends ///-->


<script type="text/javascript">
  //Dom ready
  en4.core.runonce.add(function () {
    loadLeaderboardResults();
    $$('#reviewSingleModal').addEvent('show.bs.modal', function (e) {
      console.log(e.relatedTarget);
    })
  });

  function loadLeaderboardResults() {
    //Request data can be linked to form inputs
    var requestData = {};
    // requestData.limit = 10;
    // requestData.page = 1;
    var loader = en4.core.loader.clone();
    loader.addClass("sd_loader");
    var url = en4.core.baseUrl + "api/v1/review";

    var buildCardRating = function (rating, max) {
      var html = '';
      for (var i = 0; i < rating; i++) {
        html +=
          '<li class="list-inline-item align-middle">\n' +
          '<span class="card-star--icon"></span>\n' +
          '</li>'
      }
      if (max - rating > 0) {
        for (var j = 0; j < max - rating; j++) {
          html +=
            '<li class="list-inline-item align-middle">\n' +
            '<span style="opacity: .4" class="card-star--icon"></span>\n' +
            '</li>'
        }
      }
      return html;
    }
    var buildCard = function (rev, options) {
      var createdDt = new Date(rev.createdDateTime).toString().split(' ');
      var createdMonth = createdDt[1];
      var createdDay = createdDt[2].charAt(0) == 0 ? createdDt[2].split('')[1] : createdDt[2];

      return '<div class="col-6 col-lg-4 p-2">\n' +
        '                    <!--single review card-->\n' +
        '                    <div class="card card-review h-100 d-flex flex-column" data-id="' + rev.reviewID + '">\n' +
        '                      <div class="card-header p-0 overflow-hidden">\n' +
        '                        <div class="card-actions">\n' +
        '                          <ul class="row no-gutters mb-0">\n' +
        '                            <li class="col"><a class="d-flex justify-content-center align-items-center text-white"\n' +
        '                                               role="button"><span class="far fa-heart"></span></a></li>\n' +
        '                            <li class="col"><a class="d-flex justify-content-center align-items-center text-white"\n' +
        '                                               role="button"><span class="fas fa-clipboard"></span></a></li>\n' +
        '                            <li class="col"><a class="d-flex justify-content-center align-items-center text-white"\n' +
        '                                               role="button"><span class="fab fa-facebook-f"></span></a></li>\n' +
        '                            <li class="col"><a class="d-flex justify-content-center align-items-center text-white"\n' +
        '                                               role="button"><span class="fab fa-twitter"></span></a></li>\n' +
        '                            <li class="col"><a class="d-flex justify-content-center align-items-center text-white"\n' +
        '                                               role="button"><span class="fab fa-pinterest"></span></a></li>\n' +
        '                            <li class="col"><a class="d-flex justify-content-center align-items-center text-white"\n' +
        '                                               role="button"><span class="fas fa-link"></span></a></li>\n' +
        '                          </ul>\n' +
        '                        </div>\n' +
        '                        <a data-target="#reviewSingleModal" data-toggle="modal"\n' +
        '                           data-call="' + en4.core.baseUrl + 'api/v1/review?' + rev.reviewID + '"\n' +
        '                           class="d-block card-img--wrapper"\n' +
        '                             style="background-image: url(' + rev.coverPhoto.photoURL + ')">\n' +
        '                          <img class="invisible w-100 h-100 position-absolute" src="' + rev.coverPhoto.photoURL + '" alt="' + rev.title + '"/>\n' +
        '                        </a>\n' +
        '                        <div class="card-stars">\n' +
        '                          <ul class="list-inline my-0">\n' +
        buildCardRating(rev.authorRating, 5) +
        '                          </ul>\n' +
        '                        </div>\n' +
        '                      </div>\n' +
        '                      <div class="card-body">\n' +
        '                        <h6 class="card-subtitle my-1 text-primary font-weight-bold">' + rev.reviewCategorization.category + '</h6>\n' +
        '                        <h5 class="card-title font-weight-bold">' + rev.title + '</h5>\n' +
        '                        <p class="card-text mb-0 d-none d-sm-block">' + rev.shortDescription + '</p>\n' +
        '                      </div>\n' +
        '                      <div class="card-footer bg-white">\n' +
        '                        <div class="row align-items-center justify-content-between flex-nowrap">\n' +
        '                          <div class="col-auto col-sm">\n' +
        '                            <div class="card-author">\n' +
        '                              <div class="row no-gutters flex-nowrap align-items-center">\n' +
        '                                <div class="col-auto d-none d-sm-block">\n' +
        '                                  <div class="position-relative card-author--thumbnail">\n' +
        '                                    <img class="rounded-circle"\n' +
        '                                         src="http://dzhywv9htu615.cloudfront.net/public/user/b3/03/03b0_84cd.png"\n' +
        '                                         alt="Generic placeholder image">\n' +
        '                                    <b class="position-absolute d-flex justify-content-center align-items-center text-white bagde badge-primary rounded-circle ff-open--sans card-author--rank">' + rev.author.contributionLevel + '</b>\n' +
        '                                  </div>\n' +
        '                                </div>\n' +
        '                                <div class="col">\n' +
        '                                  <a href="' + en4.core.baseUrl + 'profile/' + rev.author.memberName + '">\n' +
        '                                     <h6 class="card-author--title mb-0"><b>' + rev.author.displayName + '</b></h6>\n' +
        '                                  </a>\n' +
        '                                  <div class="card-date">\n' +
        '                                    <span class="ff-open--sans text-asphalt small">' + createdMonth + ' ' + createdDay + '</span>\n' +
        '                                  </div>\n' +
        '                                 </div>\n' +
        '                              </div>\n' +
        '                            </div>\n' +
        '                          </div>\n' +
        '                          <div class="col-auto text-right d-none d-sm-block">\n' +
        '                            <ul class="list-inline my-0">\n' +
        '                              <li class="flex-row align-items-center list-inline-item">\n' +
        '                                <span class="fas fa-heart"></span>\n' +
        '                                <span class="text-asphalt">' + rev.likesCount + '</span>\n' +
        '                              </li>\n' +
        '                              <li class="flex-row align-items-center list-inline-item">\n' +
        '                                <span class="fas fa-comments"></span>\n' +
        '                                <span class="text-asphalt">' + rev.commentsCount + '</span>\n' +
        '                              </li>\n' +
        '                            </ul>\n' +
        '                          </div>\n' +
        '                          <div class="col-auto text-center d-sm-none">\n' +
        '                          <button class="btn bg-transparent btn-card--details">\n' +
        '                            <i class="fa fa-ellipsis-h mr-0"></i>\n' +
        '                          </button>\n' +
        '                        </div>\n' +
        '                        </div>\n' +

        '                      </div>\n' +
        '                    </div>\n' +
        '                  </div>';
    };


    var request = new Request.JSON({
      url: url,
      method: 'GET',
      data: requestData,
      onRequest: function () {
        loader.classList.add('is-loading');
      }, //When request is sent.
      onError: function () {
        loader.destroy();
      }, //When request throws an error.
      onCancel: function () {
        loader.destroy();
      }, //When request is cancelled.
      onSuccess: function (responseJSON) { //When request is succeeded.
        if (responseJSON.status_code == 200) {
          var reviews = responseJSON.body.Results;
          var $reviewsHtml = '';
          for (var j = 0; j < reviews.length; j++) {
            $reviewsHtml += buildCard(reviews[j]);
            $('featuredReviewsGrid').innerHTML = $reviewsHtml;
          }
        } else {
          alert(responseJSON.message);
        }
        loader.destroy();
      }
    });

    request.send();
  }

</script>